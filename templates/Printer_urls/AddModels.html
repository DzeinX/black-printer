{% extends 'base.html' %}

{% block title %}Добавить модели{% endblock %}

{% block script %}
    <script src="{{ url_for('static', filename='js/TableSearchForAll.js') }}"></script>
    <script>
        let items = {{ counter_models }};

        function AddItem() {
            const table = document.getElementById("table").getElementsByTagName('tbody')[0];
            items++;
            let id = "d" + items
            let newRow = table.insertRow()
            newRow.setAttribute('id', id)
            let tdFirst = document.createElement("td")
            let tdSecond = document.createElement("td")
            let tdThird = document.createElement("td")
            tdFirst.innerHTML = `
                <td style="">
                    <label for="${items}">${items} </label>
                </td>`;
            tdSecond.innerHTML = `
                <td style="">
                    <input id="${items}"
                           type="text"
                           class="enter"
                           name="model">
                </td>`;
            tdThird.innerHTML = `
                <td>
                    <input type="button" value="✕" class="delete_btn" onclick="RemoveItem('d${items}');" id="r${items}">
                </td>`;
            newRow.appendChild(tdFirst)
            newRow.appendChild(tdSecond)
            newRow.appendChild(tdThird)
        }

        function RemoveItem(id_div) {
            const div = document.getElementById(id_div);
            div.remove();
            items--;
        }

    </script>
{% endblock %}

{% block body %}
    <h1>Модели принтеров:</h1>
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% for category, message in messages %}
            <div class="{{ category }}">{{ message }}</div>
        {% endfor %}
    {% endwith %}
    <form method="POST">
        <div class="form" id="items">
            {% set counter = namespace(value=1) %}
            <table id="table">
                <colgroup>
                    <col span="1" style="width: 5%;">
                    <col span="1" style="width: calc(95% - 28px);">
                    <col span="1" style="width: 28px;">
                </colgroup>
                <thead>
                <tr>
                    <th style="">№</th>
                    <th style="">Модель</th>
                    <th style=""></th>
                </tr>
                <tr id="search-table">
                    <th style="">
                        <i class="fa-solid fa-magnifying-glass"></i>
                    </th>
                    <th class="search-table-item" style="">
                        <input type="text" placeholder="Начните вводить" id="sch2" class="enter">
                    </th>
                    <th></th>
                </tr>
                </thead>
                <tbody id="searched-fields">
                {% for model in list_models %}
                    <tr id="d{{ loop.index }}">
                        <td style="">
                            <label for="{{ loop.index }}">{{ counter.value }} </label>
                        </td>
                        <td style="" class="sorted-field">
                            <input id="{{ loop.index }}"
                                   type="text"
                                   value="{{ model.model }}"
                                   name="model"
                                   class="enter">
                        </td>
                        <td style="">
                            <input type="button" value="✕" class="delete_btn"
                                   onclick="RemoveItem('d{{ loop.index }}');" id="r{{ loop.index }}">
                        </td>
                        {% set counter.value = counter.value + 1 %}
                    </tr>
                {% endfor %}
                </tbody>
            </table>
            <input type="button" value="Добавить поле" class="add_field" onclick="AddItem();" id="add"><br>
            <input type="submit" value="Обновить" class="add_btn">
        </div>
    </form>

{% endblock %}



